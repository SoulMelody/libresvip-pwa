import{r as a,a0 as pe,bi as me,d3 as be,z as q,de as v,w as f,a6 as _,j as i,bV as fe,bW as ge,cf as he,bX as ye,bK as ve,c as S,a5 as we,c2 as X,l as xe,E as J,e as Q}from"./index-tFDW8sZg.js";import{c as Ie}from"./uniqueId-DPhWsxhl-BsWnzeYP.js";import{b as Te}from"./InputInstructions-CgG5kqFi-BDKtPJEI.js";import{n as Ce}from"./FormClearHelper-oDeZ7GIm-BIbeh7TY.js";import{S as ke}from"./sprintf-CQZ7AWXD-CuWy5xoB.js";import{_ as Se}from"./input-D23oJQu9-Ck7nYtKk.js";import"./base-input-D89iciT3-DtiyZ5cB.js";var Y=a.forwardRef(function(e,t){var l={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return a.createElement(J,Q({iconAttrs:l,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},e,{ref:t}),a.createElement("path",{d:"M0 3v2h8V3H0z"}))});Y.displayName="Minus";var Z=a.forwardRef(function(e,t){var l={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return a.createElement(J,Q({iconAttrs:l,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},e,{ref:t}),a.createElement("path",{d:"M3 0v3H0v2h3v3h2V5h3V3H5V0H3z"}))});Z.displayName="Plus";const Ee=S("div",{target:"e116k4er3"})(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center",height:e.sizes.minElementHeight,borderWidth:e.sizes.borderWidth,borderStyle:"solid",borderColor:e.colors.widgetBorderColor??e.colors.secondaryBg,transitionDuration:"200ms",transitionProperty:"border",transitionTimingFunction:"cubic-bezier(0.2, 0.8, 0.4, 1)",borderRadius:e.radii.default,overflow:"hidden","&.focused":{borderColor:e.colors.primary},input:{MozAppearance:"textfield","&::-webkit-inner-spin-button, &::-webkit-outer-spin-button":{WebkitAppearance:"none",margin:e.spacing.none}}}),""),Re=S("div",{target:"e116k4er2"})({name:"76z9jo",styles:"display:flex;flex-direction:row;align-self:stretch"}),K=S("button",{target:"e116k4er1"})(({theme:e})=>({margin:e.spacing.none,border:"none",height:e.sizes.full,display:"flex",alignItems:"center",width:e.sizes.numberInputControlsWidth,justifyContent:"center",color:e.colors.bodyText,transition:"color 300ms, backgroundColor 300ms",backgroundColor:e.colors.secondaryBg,"&:hover:enabled, &:focus:enabled":{color:e.colors.white,backgroundColor:e.colors.primary,transition:"none",outline:"none"},"&:active":{outline:"none",border:"none"},"&:disabled":{cursor:"not-allowed",color:e.colors.fadedText40}}),""),Ve=S("div",{target:"e116k4er0"})(({theme:e,clearable:t})=>({position:"absolute",marginRight:e.spacing.twoXS,left:0,right:`calc(${e.sizes.numberInputControlsWidth} * 2 + ${t?"1em":"0em"})`}),""),Ne=xe.getLogger("NumberInput");function ze(e){return f(e)||e===""?void 0:e}const W=({value:e,format:t,step:l,dataType:b})=>{if(f(e))return null;let r=ze(t);if(f(r)&&q(l)){const p=l.toString();b===v.DataType.FLOAT&&l!==0&&p.includes(".")&&(r=`%0.${p.split(".")[1].length}f`)}if(f(r))return e.toString();try{return ke.sprintf(r,e)}catch(p){return Ne.warn(`Error in sprintf(${r}, ${e}): ${p}`),String(e)}},We=(e,t,l)=>f(e)?!1:e-t>=l,je=(e,t,l)=>f(e)?!1:e+t<=l,De=e=>(e.element.dataType===v.DataType.INT?e.widgetMgr.getIntValue(e.element):e.widgetMgr.getDoubleValue(e.element))??e.element.default??null,G=({step:e,dataType:t})=>e||(t===v.DataType.INT?1:.01),Fe=({disabled:e,element:t,widgetMgr:l,fragmentId:b})=>{const r=pe(),{dataType:p,id:E,formId:m,default:j,format:D,icon:R,min:g,max:h}=t,[F,$]=me(),[n,ee]=a.useState(()=>G(t)),L=De({element:t,widgetMgr:l}),[y,w]=a.useState(!1),[d,x]=a.useState(L),[B,I]=a.useState(()=>W({value:L,...t,step:n})),[A,U]=a.useState(!1),T=a.useRef(null),M=a.useRef(Ie("number_input_")),C=We(d,n,g),k=je(d,n,h),H=be({formId:m}),te=H?l.allowFormEnterToSubmit(m):y,re=A&&F>r.breakpoints.hideWidgetDetails;a.useEffect(()=>{ee(G({step:t.step,dataType:t.dataType}))},[t.dataType,t.step]);const u=a.useCallback(({value:o,source:s})=>{if(q(o)&&(g>o||o>h))T.current?.reportValidity();else{const c=o??j??null;switch(p){case v.DataType.INT:l.setIntValue({id:E,formId:m},c,s,b);break;case v.DataType.FLOAT:l.setDoubleValue({id:E,formId:m},c,s,b);break;default:throw new Error("Invalid data type")}w(!1),x(c),I(W({value:c,dataType:p,format:D,step:n}))}},[g,h,T,l,b,n,p,E,m,j,D]),ae=a.useCallback(()=>{y&&u({value:d,source:{fromUi:!0}}),U(!1)},[y,d,u]),oe=a.useCallback(()=>{U(!0)},[]),P=a.useCallback(()=>{const{value:o}=t;t.setValue=!1,x(o??null),I(W({value:o??null,...t,step:n})),u({value:o??null,source:{fromUi:!1}})},[t,n,u]);a.useEffect(()=>{t.setValue?P():u({value:d,source:{fromUi:!1}});const o=T.current;if(o){const s=c=>{c.preventDefault()};return o.addEventListener("wheel",s),()=>{o.removeEventListener("wheel",s)}}},[]),t.setValue&&P();const V=f(t.default)&&!e,le=a.useCallback(()=>{const o=t.default??null;x(o),u({value:o,source:{fromUi:!0}})},[t]);Ce({element:t,widgetMgr:l,onFormCleared:le});const ie=o=>{const{value:s}=o.target;if(s==="")w(!0),x(null),I(null);else{let c;t.dataType===v.DataType.INT?c=parseInt(s,10):c=parseFloat(s),w(!0),x(c),I(s)}},N=a.useCallback(()=>{k&&(w(!0),u({value:(d??g)+n,source:{fromUi:!0}}))},[d,g,n,k]),z=a.useCallback(()=>{C&&(w(!0),u({value:(d??h)-n,source:{fromUi:!0}}))},[d,h,n,C]),ne=a.useCallback(o=>{const{key:s}=o;switch(s){case"ArrowUp":o.preventDefault(),N();break;case"ArrowDown":o.preventDefault(),z();break}},[N,z]),se=a.useCallback(o=>{o.key==="Enter"&&(y&&u({value:d,source:{fromUi:!0}}),l.allowFormEnterToSubmit(m)&&l.submitForm(m,b))},[y,d,u,l,m,b]),O=R?.startsWith(":material"),de=O?"lg":"base",ue=_(r.iconSizes.lg)+2*_(r.spacing.twoXS),ce=R?r.breakpoints.hideNumberInputControls+ue:r.breakpoints.hideNumberInputControls;return i.jsxs("div",{className:"stNumberInput","data-testid":"stNumberInput",ref:$,children:[i.jsx(fe,{label:t.label,disabled:e,labelVisibility:ge(t.labelVisibility?.value),htmlFor:M.current,children:t.help&&i.jsx(he,{children:i.jsx(ye,{content:t.help,placement:ve.TOP_RIGHT})})}),i.jsxs(Ee,{className:A?"focused":"","data-testid":"stNumberInputContainer",children:[i.jsx(Se,{type:"number",inputRef:T,value:B??"",placeholder:t.placeholder,onBlur:ae,onFocus:oe,onChange:ie,onKeyPress:se,onKeyDown:ne,clearable:V,clearOnEscape:V,disabled:e,"aria-label":t.label,startEnhancer:t.icon&&i.jsx(we,{"data-testid":"stNumberInputIcon",iconValue:t.icon,size:de}),id:M.current,overrides:{ClearIconContainer:{style:{padding:0}},ClearIcon:{props:{overrides:{Svg:{style:{color:r.colors.darkGray,padding:r.spacing.threeXS,height:r.sizes.clearIconSize,width:r.sizes.clearIconSize,":hover":{fill:r.colors.bodyText}}}}}},Input:{props:{"data-testid":"stNumberInputField",step:n,min:g,max:h,type:"number",inputMode:""},style:{fontWeight:r.fontWeights.normal,lineHeight:r.lineHeights.inputWidget,paddingRight:r.spacing.sm,paddingLeft:r.spacing.md,paddingBottom:r.spacing.sm,paddingTop:r.spacing.sm,"::placeholder":{color:r.colors.fadedText60}}},InputContainer:{style:()=>({borderTopRightRadius:0,borderBottomRightRadius:0})},Root:{style:{borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,borderBottomWidth:0,paddingRight:0,paddingLeft:R?r.spacing.sm:0}},StartEnhancer:{style:{paddingLeft:0,paddingRight:0,minWidth:r.iconSizes.lg,color:O?r.colors.fadedText60:"inherit"}}}}),F>ce&&i.jsxs(Re,{children:[i.jsx(K,{"data-testid":"stNumberInputStepDown",onClick:z,disabled:!C||e,tabIndex:-1,children:i.jsx(X,{content:Y,size:"xs",color:C?"inherit":r.colors.disabled})}),i.jsx(K,{"data-testid":"stNumberInputStepUp",onClick:N,disabled:!k||e,tabIndex:-1,children:i.jsx(X,{content:Z,size:"xs",color:k?"inherit":r.colors.disabled})})]})]}),re&&i.jsx(Ve,{clearable:V,children:i.jsx(Te,{dirty:y,value:B??"",inForm:H,allowEnterToSubmit:te})})]})},Oe=a.memo(Fe);export{Oe as default};
