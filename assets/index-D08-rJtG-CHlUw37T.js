import{r as s,a0 as C,cs as I,cG as M,cH as V,cI as $,j as r,bV as j,bW as L,cf as P,bX as E,bK as k,c as B,cx as F,cJ as H,cB as O,cK as A,cg as D}from"./index-BbQzo7sj.js";import{F as G}from"./useBasicWidgetState-DZWY5hj--CzCP_9rA.js";import"./FormClearHelper-B_V_qF_E-10ThjYV4.js";const K=B("div",{target:"e6zijwc0"})(({theme:i})=>({"span[aria-disabled='true']":{background:i.colors.fadedText05}}),""),N=(i,t)=>i.getStringArrayValue(t),U=i=>i.default.map(t=>i.options[t])??null,Y=i=>i.rawValues??null,X=(i,t,l,n)=>{t.setStringArrayValue(i,l.value,{fromUi:l.fromUi},n)},_=i=>{const{element:t,widgetMgr:l,fragmentId:n}=i,e=C(),h=s.useContext(I),[a,u]=G({getStateFromWidgetMgr:N,getDefaultStateFromProto:U,getCurrStateFromProto:Y,updateWidgetMgrState:X,element:t,widgetMgr:l,fragmentId:n}),g=t.maxSelections>0&&a.length>=t.maxSelections,b=s.useMemo(()=>{if(t.maxSelections===0)return"No results";if(a.length===t.maxSelections){const o=t.maxSelections!==1?"options":"option";return`You can only select up to ${t.maxSelections} ${o}. Remove an option first.`}return"No results"},[t.maxSelections,a.length]),f=s.useMemo(()=>a.map(o=>({value:o,label:o})),[a]),m=s.useCallback(o=>{switch(o.type){case"remove":return M(a,o.option?.value);case"clear":return[];case"select":return a.concat([o.option?.value]);default:throw new Error(`State transition is unknown: ${o.type}`)}},[a]),S=s.useCallback(o=>{t.maxSelections&&o.type==="select"&&a.length>=t.maxSelections||u({value:m(o),fromUi:!0})},[t.maxSelections,m,u,a.length]),x=s.useCallback((o,p)=>{if(g)return[];const T=o.filter(W=>!a.includes(W.value));return V(T,p)},[g,a]),{options:c}=t,{placeholder:y,shouldDisable:v}=$(t.placeholder,c,t.acceptNewOptions??!1,!0),d=i.disabled||v,z=c.map((o,p)=>({label:o,value:o,id:`${o}_${p}`})),w=c.length>10,R=s.useMemo(()=>{const o=e.fontSizes.baseFontSize*1.6+14;return`${Math.round(o*4.25)}px`},[e.fontSizes.baseFontSize]);return r.jsxs("div",{className:"stMultiSelect","data-testid":"stMultiSelect",children:[r.jsx(j,{label:t.label,disabled:d,labelVisibility:L(t.labelVisibility?.value),children:t.help&&r.jsx(P,{children:r.jsx(E,{content:t.help,placement:k.TOP_RIGHT})})}),r.jsx(K,{children:r.jsx(F,{creatable:t.acceptNewOptions??!1,options:z,labelKey:"label",valueKey:"value","aria-label":t.label,placeholder:y,type:A.select,multi:!0,onChange:S,value:f,disabled:d,size:"compact",noResultsMsg:b,filterOptions:x,closeOnSelect:!1,ignoreCase:!1,overrides:{Popover:{props:{ignoreBoundary:h,overrides:{Body:{style:()=>({marginTop:e.spacing.px})}}}},SelectArrow:{component:O,props:{style:{cursor:"pointer"},overrides:{Svg:{style:()=>({width:e.iconSizes.xl,height:e.iconSizes.xl})}}}},IconsContainer:{style:()=>({paddingRight:e.spacing.sm})},ControlContainer:{style:{maxHeight:R,minHeight:e.sizes.minElementHeight,borderLeftWidth:e.sizes.borderWidth,borderRightWidth:e.sizes.borderWidth,borderTopWidth:e.sizes.borderWidth,borderBottomWidth:e.sizes.borderWidth}},Placeholder:{style:()=>({flex:"inherit",color:d?e.colors.fadedText40:e.colors.fadedText60})},ValueContainer:{style:()=>({overflowY:"auto",paddingLeft:e.spacing.sm,paddingTop:e.spacing.none,paddingBottom:e.spacing.none,paddingRight:e.spacing.none})},ClearIcon:{props:{overrides:{Svg:{style:{color:e.colors.darkGray,padding:e.spacing.threeXS,height:e.sizes.clearIconSize,width:e.sizes.clearIconSize,cursor:"pointer",":hover":{fill:e.colors.bodyText}}}}}},SearchIcon:{style:{color:e.colors.darkGray}},Tag:{props:{overrides:{Root:{style:{fontWeight:e.fontWeights.normal,borderTopLeftRadius:e.radii.md,borderTopRightRadius:e.radii.md,borderBottomRightRadius:e.radii.md,borderBottomLeftRadius:e.radii.md,fontSize:e.fontSizes.md,paddingLeft:e.spacing.sm,marginLeft:e.spacing.none,marginRight:e.spacing.sm,height:`calc(${e.sizes.minElementHeight} - 2 * ${e.spacing.xs})`,maxWidth:`calc(100% - ${e.spacing.lg})`,cursor:"default !important"}},Action:{style:{paddingLeft:0}},ActionIcon:{props:{overrides:{Svg:{style:{width:"0.625em",height:"0.625em"}}}}}}}},MultiValue:{props:{overrides:{Root:{style:{fontSize:e.fontSizes.sm}}}}},Input:{props:{readOnly:D()&&w===!1?"readonly":null}},Dropdown:{component:H}}})})]})},Z=s.memo(_);export{Z as default};
