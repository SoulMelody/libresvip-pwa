import{r as n,u as x,a as y,j as m,c as E,l as A}from"./index-Dxdo2zmA.js";const h=E("div",{target:"exyuj7n1"})(()=>({lineHeight:0}),""),j=E("audio",{target:"exyuj7n0"})(({theme:r})=>({width:"100%",height:r.sizes.minElementHeight,margin:0,padding:0}),""),L=A.getLogger("Audio");function C({element:r,endpoints:d,elementMgr:a}){const s=n.useRef(null),{startTime:i,endTime:o,loop:u,autoplay:f}=r,g=n.useMemo(()=>{if(!r.id)return!0;const e=a.getElementState(r.id,"preventAutoplay");return e||a.setElementState(r.id,"preventAutoplay",!0),e??!1},[r.id,a]);n.useEffect(()=>{s.current&&(s.current.currentTime=i)},[i]),n.useEffect(()=>{const e=s.current,t=()=>{e&&(e.currentTime=r.startTime)};return e&&e.addEventListener("loadedmetadata",t),()=>{e&&e.removeEventListener("loadedmetadata",t)}},[r]),n.useEffect(()=>{const e=s.current;if(!e)return;let t=!1;const l=()=>{o>0&&e.currentTime>=o&&(u?(e.currentTime=i||0,e.play()):t||(t=!0,e.pause()))};return o>0&&e.addEventListener("timeupdate",l),()=>{e&&o>0&&e.removeEventListener("timeupdate",l)}},[o,u,i]),n.useEffect(()=>{const e=s.current;if(!e)return;const t=()=>{u&&(e.currentTime=i||0,e.play())};return e.addEventListener("ended",t),()=>{e&&e.removeEventListener("ended",t)}},[u,i]);const c=x(r.url),p=y(c),v=d.buildMediaURL(c),T=e=>{const t=e.currentTarget.src;L.error(`Client Error: Audio source error - ${t}`),d.sendClientErrorToHost("Audio","Audio source failed to load","onerror triggered",t)};return m.jsx(h,{children:m.jsx(j,{className:"stAudio","data-testid":"stAudio",ref:s,controls:!0,autoPlay:f&&!g,src:v,onError:T,crossOrigin:p})})}const M=n.memo(C);export{M as default};
