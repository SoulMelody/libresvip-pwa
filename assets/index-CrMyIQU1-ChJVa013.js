import{r as a,bi as P,a0 as U,d3 as W,j as s,c as _,bV as B,bW as y,cf as G,bX as K,bK as O,d4 as N}from"./index-Ch-AAoqE.js";import{c as X}from"./uniqueId-DPhWsxhl-CoU0MWcO.js";import{b as q}from"./InputInstructions-CgG5kqFi-ncc6luRL.js";import{F as J}from"./useBasicWidgetState-C59Rmhxk-DQcVZdcw.js";import{b as Q,c as Y,f as Z}from"./useUpdateUiValue-mrphtHym-CP09mK8a.js";import{o as ee,x as te}from"./useTextInputAutoExpand-CMwmI3jW-Rq-geNIa.js";import"./FormClearHelper-oDeZ7GIm-BdmqdW5-.js";import"./inputUtils-DCYiajnz-nYhVeN7j.js";import"./base-input-D89iciT3-l9xvmInn.js";const ie=(t,e)=>{let l="auto";if(t.heightConfig?.useStretch)l="100%";else if(t.heightConfig?.pixelHeight&&t.heightConfig.pixelHeight>0){const o=y(e.labelVisibility?.value)===N.Collapsed?2:30;l=`${t.heightConfig.pixelHeight-o}px`}return l},le=_("div",{target:"ezh4s2r0"})({name:"kdbhus",styles:"height:100%;display:flex;flex-direction:column"}),S=(t,e)=>t.getStringValue(e)??e.default??null,ae=t=>t.default??null,oe=t=>t.value??null,re=(t,e,l,o)=>{e.setStringValue(t,l.value,{fromUi:l.fromUi},o)},se=({disabled:t,element:e,widgetMgr:l,fragmentId:o,outerElement:m})=>{const c=a.useRef(X("text_area_")).current,[T,H]=P(),[r,u]=a.useState(!1),[I,b]=a.useState(!1),d=m.heightConfig?.useContent??!1,v=m.heightConfig?.useStretch??!1,V=ie(m,e),x=a.useRef(null),[n,g]=a.useState(()=>S(l,e)??null),F=a.useCallback(()=>{g(e.default??null),u(!0)},[e]),[R,h]=J({getStateFromWidgetMgr:S,getDefaultStateFromProto:ae,getCurrStateFromProto:oe,updateWidgetMgrState:re,element:e,widgetMgr:l,fragmentId:o,onFormCleared:F});Q(R,n,g,r);const i=U(),{height:E,maxHeight:$,updateScrollHeight:C}=ee({textareaRef:x,dependencies:[e.placeholder]}),f=a.useCallback(()=>{u(!1),h({value:n,fromUi:!0})},[n,h]),j=a.useCallback(()=>{r&&f(),b(!1)},[r,f]),k=a.useCallback(()=>{b(!0)},[]),z=a.useCallback(()=>{d&&C()},[d,C]),w=Y({formId:e.formId,maxChars:e.maxChars,setDirty:u,setUiValue:g,setValueWithSource:h,additionalAction:z}),L=Z(e.formId,f,r,l,o,!0),{placeholder:A,formId:p}=e,D=W({formId:p})?l.allowFormEnterToSubmit(p):r,M=I&&T>i.breakpoints.hideWidgetDetails;return s.jsxs(le,{className:"stTextArea","data-testid":"stTextArea",ref:H,children:[s.jsx(B,{label:e.label,disabled:t,labelVisibility:y(e.labelVisibility?.value),htmlFor:c,children:e.help&&s.jsx(G,{children:s.jsx(K,{content:e.help,placement:O.TOP_RIGHT})})}),s.jsx(te,{inputRef:d?x:void 0,value:n??"",placeholder:A,onBlur:j,onFocus:k,onChange:w,onKeyDown:L,"aria-label":e.label,disabled:t,id:c,overrides:{Input:{style:{fontWeight:i.fontWeights.normal,lineHeight:i.lineHeights.inputWidget,height:d?E:V,maxHeight:d?$:"",minHeight:i.sizes.largestElementHeight,resize:v?"none":"vertical",paddingRight:i.spacing.md,paddingLeft:i.spacing.md,paddingBottom:i.spacing.md,paddingTop:i.spacing.md,"::placeholder":{color:i.colors.fadedText60}}},Root:{props:{"data-testid":"stTextAreaRootElement"},style:{borderLeftWidth:i.sizes.borderWidth,borderRightWidth:i.sizes.borderWidth,borderTopWidth:i.sizes.borderWidth,borderBottomWidth:i.sizes.borderWidth,flexGrow:1}}}}),M&&s.jsx(q,{dirty:r,value:n??"",maxLength:e.maxChars,type:"multiline",inForm:W({formId:p}),allowEnterToSubmit:D})]})},be=a.memo(se);export{be as default};
