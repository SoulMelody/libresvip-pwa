import{r as o,v as s}from"./index-B_CN4CJH.js";import{d as S}from"./FormClearHelper-D8MdXVn3-NTpCcfAz.js";function M({getStateFromWidgetMgr:f,getDefaultState:a,updateWidgetMgrState:l,element:t,widgetMgr:e,fragmentId:n,onFormCleared:d}){const[m,i]=o.useState(()=>f(e,t)??a(e,t)),[g,r]=o.useState({value:m,fromUi:!1});o.useEffect(()=>{s(g)||(r(null),i(g.value),l(t,e,g,n))},[g,l,t,e,n]);const u=o.useCallback(()=>{r({value:a(e,t),fromUi:!0}),d?.()},[r,t,a,e,d]);return S({widgetMgr:e,element:t,onFormCleared:u}),[m,r]}function C({getStateFromWidgetMgr:f,getDefaultStateFromProto:a,getCurrStateFromProto:l,updateWidgetMgrState:t,element:e,widgetMgr:n,fragmentId:d,onFormCleared:m}){const i=o.useCallback((u,c)=>a(c),[a]),[g,r]=M({getStateFromWidgetMgr:f,getDefaultState:i,updateWidgetMgrState:t,element:e,widgetMgr:n,fragmentId:d,onFormCleared:m});return o.useEffect(()=>{e.setValue&&(e.setValue=!1,r({value:l(e),fromUi:!1}))},[e,l,r]),[g,r]}export{C as W,M as p};
