import{r,m as W,cS as M,d4 as I,d5 as O,j as a,cl as V,cm as j,cF as L,cn as $,c7 as E,c as P,cT as F,d6 as A,cX as B,d7 as H}from"./index-B_CN4CJH.js";import{W as N}from"./useBasicWidgetState-DTudxgQh-C_dMYmMi.js";import"./FormClearHelper-D8MdXVn3-NTpCcfAz.js";const k=P("div",{target:"e6zijwc0"})(({theme:o})=>({"span[aria-disabled='true']":{background:o.colors.fadedText05}}),""),D=(o,t)=>o.getStringArrayValue(t),U=o=>o.default.map(t=>o.options[t])??null,Y=o=>o.rawValues??null,K=(o,t,l,n)=>{t.setStringArrayValue(o,l.value,{fromUi:l.fromUi},n)},X=o=>{const{element:t,widgetMgr:l,fragmentId:n}=o,e=W(),h=r.useContext(M),[s,c]=N({getStateFromWidgetMgr:D,getDefaultStateFromProto:U,getCurrStateFromProto:Y,updateWidgetMgrState:K,element:t,widgetMgr:l,fragmentId:n}),p=t.maxSelections>0&&s.length>=t.maxSelections,S=r.useMemo(()=>{if(t.maxSelections===0)return"No results";if(s.length===t.maxSelections){const i=t.maxSelections!==1?"options":"option";return`You can only select up to ${t.maxSelections} ${i}. Remove an option first.`}return"No results"},[t.maxSelections,s.length]),m=r.useCallback(i=>{switch(i.type){case"remove":return I(s,i.option?.value);case"clear":return[];case"select":return s.concat([i.option?.value]);default:throw new Error(`State transition is unknown: ${i.type}`)}},[s]),f=r.useCallback(i=>{t.maxSelections&&i.type==="select"&&s.length>=t.maxSelections||c({value:m(i),fromUi:!0})},[t.maxSelections,m,c,s.length]),{options:b}=t,{placeholder:x,disabled:y,selectOptions:v,inputReadOnly:z,valuesToUiMulti:g,createFilterOptions:u}=O({options:b,isMulti:!0,acceptNewOptions:t.acceptNewOptions??!1,placeholderInput:t.placeholder}),w=r.useCallback((i,C)=>p?[]:u(s)(i,C),[u,p,s]),d=o.disabled||y,T=r.useMemo(()=>g(s),[g,s]),R=r.useMemo(()=>{const i=e.fontSizes.baseFontSize*1.6+14;return`${Math.round(i*4.25)}px`},[e.fontSizes.baseFontSize]);return a.jsxs("div",{className:"stMultiSelect","data-testid":"stMultiSelect",children:[a.jsx(V,{label:t.label,disabled:d,labelVisibility:j(t.labelVisibility?.value),children:t.help&&a.jsx(L,{children:a.jsx($,{content:t.help,placement:E.TOP_RIGHT})})}),a.jsx(k,{children:a.jsx(F,{creatable:t.acceptNewOptions??!1,options:v,labelKey:"label",valueKey:"value","aria-label":t.label,placeholder:x,type:H.select,multi:!0,onChange:f,value:T,disabled:d,size:"compact",noResultsMsg:S,filterOptions:w,closeOnSelect:!1,ignoreCase:!1,overrides:{Popover:{props:{ignoreBoundary:h,overrides:{Body:{style:()=>({marginTop:e.spacing.px})}}}},SelectArrow:{component:B,props:{style:{cursor:"pointer"},overrides:{Svg:{style:()=>({width:e.iconSizes.xl,height:e.iconSizes.xl})}}}},IconsContainer:{style:()=>({paddingRight:e.spacing.sm})},ControlContainer:{style:{maxHeight:R,minHeight:e.sizes.minElementHeight,borderLeftWidth:e.sizes.borderWidth,borderRightWidth:e.sizes.borderWidth,borderTopWidth:e.sizes.borderWidth,borderBottomWidth:e.sizes.borderWidth}},Placeholder:{style:()=>({flex:"inherit",color:d?e.colors.fadedText40:e.colors.fadedText60})},ValueContainer:{style:()=>({overflowY:"auto",paddingLeft:e.spacing.sm,paddingTop:e.spacing.none,paddingBottom:e.spacing.none,paddingRight:e.spacing.none})},ClearIcon:{props:{overrides:{Svg:{style:{color:e.colors.grayTextColor,padding:e.spacing.threeXS,height:e.sizes.clearIconSize,width:e.sizes.clearIconSize,cursor:"pointer",":hover":{fill:e.colors.bodyText}}}}}},SearchIcon:{style:{color:e.colors.grayTextColor}},Tag:{props:{overrides:{Root:{style:{fontWeight:e.fontWeights.normal,borderTopLeftRadius:e.radii.md,borderTopRightRadius:e.radii.md,borderBottomRightRadius:e.radii.md,borderBottomLeftRadius:e.radii.md,fontSize:e.fontSizes.md,paddingLeft:e.spacing.sm,marginLeft:e.spacing.none,marginRight:e.spacing.sm,height:`calc(${e.sizes.minElementHeight} - 2 * ${e.spacing.xs})`,maxWidth:`calc(100% - ${e.spacing.lg})`,cursor:"default !important"}},Action:{style:{paddingLeft:0}},ActionIcon:{props:{overrides:{Svg:{style:{width:"0.625em",height:"0.625em"}}}}}}}},MultiValue:{props:{overrides:{Root:{style:{fontSize:e.fontSizes.sm}}}}},Input:{props:{readOnly:z}},Dropdown:{component:A}}})})]})},q=r.memo(X);export{q as default};
