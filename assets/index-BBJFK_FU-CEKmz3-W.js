import{r as o,m as pe,f as me,du as fe,x as X,dG as T,v as h,Q as P,j as i,cl as be,cm as ge,cF as he,cn as ye,c7 as ve,c as S,ae as Te,cu as _,l as we,E as J,_ as Q}from"./index-B_CN4CJH.js";import{I as xe}from"./uniqueId-CKRT4iGv-Dzv3JWez.js";import{y as Ie}from"./InputInstructions-ClHVf2-Y-CX6XkxNU.js";import{d as Ce}from"./FormClearHelper-D8MdXVn3-NTpCcfAz.js";import{_ as ke}from"./sprintf-D5E86llw-6tzWM3a-.js";import{i as Ee}from"./input-B7nj7AfH-B022p8vj.js";import"./base-input-Dqu1lvr4-DzEfVqSG.js";var Y=o.forwardRef(function(e,t){var n={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return o.createElement(J,Q({iconAttrs:n,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},e,{ref:t}),o.createElement("path",{d:"M0 3v2h8V3H0z"}))});Y.displayName="Minus";var Z=o.forwardRef(function(e,t){var n={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return o.createElement(J,Q({iconAttrs:n,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},e,{ref:t}),o.createElement("path",{d:"M3 0v3H0v2h3v3h2V5h3V3H5V0H3z"}))});Z.displayName="Plus";const Re=S("div",{target:"e116k4er3"})(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center",height:e.sizes.minElementHeight,borderWidth:e.sizes.borderWidth,borderStyle:"solid",borderColor:e.colors.widgetBorderColor??e.colors.secondaryBg,transitionDuration:"200ms",transitionProperty:"border",transitionTimingFunction:"cubic-bezier(0.2, 0.8, 0.4, 1)",borderRadius:e.radii.default,overflow:"hidden","&.focused":{borderColor:e.colors.primary},input:{MozAppearance:"textfield","&::-webkit-inner-spin-button, &::-webkit-outer-spin-button":{WebkitAppearance:"none",margin:e.spacing.none}}}),""),Se=S("div",{target:"e116k4er2"})({name:"76z9jo",styles:"display:flex;flex-direction:row;align-self:stretch"}),G=S("button",{target:"e116k4er1"})(({theme:e})=>({margin:e.spacing.none,border:"none",height:e.sizes.full,display:"flex",alignItems:"center",width:e.sizes.numberInputControlsWidth,justifyContent:"center",color:e.colors.bodyText,transition:"color 300ms, backgroundColor 300ms",backgroundColor:e.colors.secondaryBg,"&:hover:enabled, &:focus:enabled":{color:e.colors.white,backgroundColor:e.colors.primary,transition:"none",outline:"none"},"&:active":{outline:"none",border:"none"},"&:disabled":{cursor:"not-allowed",color:e.colors.fadedText40}}),""),Ne=S("div",{target:"e116k4er0"})(({theme:e,clearable:t})=>({position:"absolute",marginRight:e.spacing.twoXS,left:0,right:`calc(${e.sizes.numberInputControlsWidth} * 2 + ${t?"1em":"0em"})`}),""),Ve=we.getLogger("NumberInput");function ze(e){return h(e)||e===""?void 0:e}const R=({value:e,format:t,step:n,dataType:f})=>{if(h(e))return null;let r=ze(t);if(h(r)&&X(n)){const s=n.toString();f===T.DataType.FLOAT&&n!==0&&s.includes(".")&&(r=`%0.${s.split(".")[1].length}f`)}if(h(r))return e.toString();try{return ke.sprintf(r,e)}catch(s){return Ve.warn(`Error in sprintf(${r}, ${e}): ${s}`),String(e)}},je=(e,t,n)=>h(e)?!1:e-t>=n,De=(e,t,n)=>h(e)?!1:e+t<=n,We=e=>(e.element.dataType===T.DataType.INT?e.widgetMgr.getIntValue(e.element):e.widgetMgr.getDoubleValue(e.element))??e.element.default??null,K=({step:e,dataType:t})=>e||(t===T.DataType.INT?1:.01),Fe=({disabled:e,element:t,widgetMgr:n,fragmentId:f})=>{const r=pe(),{dataType:s,id:N,formId:m,default:W,format:b,icon:V,min:y,max:v}=t,{width:F,elementRef:q}=me(),[l,ee]=o.useState(()=>K(t)),$=We({element:t,widgetMgr:n}),[g,w]=o.useState(!1),[d,x]=o.useState($),[L,B]=o.useState(!1),C=o.useRef(null),U=o.useRef(xe("number_input_")),[A,I]=o.useState(()=>R({value:$,dataType:s,format:b,step:l})),k=je(d,l,y),E=De(d,l,v),M=fe({formId:m}),te=M?n.allowFormEnterToSubmit(m):g,re=L&&F>r.breakpoints.hideWidgetDetails;o.useEffect(()=>{ee(K({step:t.step,dataType:t.dataType}))},[t.dataType,t.step]),o.useEffect(()=>{g||I(R({value:d,dataType:s,format:b,step:l}))},[s,b,l]);const c=o.useCallback(({value:a,source:u})=>{if(X(a)&&(y>a||a>v))C.current?.reportValidity();else{const p=a??W??null;switch(s){case T.DataType.INT:n.setIntValue({id:N,formId:m},p,u,f);break;case T.DataType.FLOAT:n.setDoubleValue({id:N,formId:m},p,u,f);break;default:throw new Error("Invalid data type")}w(!1),x(p),I(R({value:p,dataType:s,format:b,step:l}))}},[y,v,C,n,f,l,s,N,m,W,b]),oe=o.useCallback(()=>{g&&c({value:d,source:{fromUi:!0}}),B(!1)},[g,d,c]),ae=o.useCallback(()=>{B(!0)},[]),H=o.useCallback(()=>{const{value:a}=t;t.setValue=!1,x(a??null),I(R({value:a??null,dataType:s,format:b,step:l})),c({value:a??null,source:{fromUi:!1}})},[t,l,c,s,b]);o.useEffect(()=>{t.setValue?H():c({value:d,source:{fromUi:!1}});const a=C.current;if(a){const u=p=>{p.preventDefault()};return a.addEventListener("wheel",u),()=>{a.removeEventListener("wheel",u)}}},[]),t.setValue&&H();const z=h(t.default)&&!e,ne=o.useCallback(()=>{const a=t.default??null;x(a),c({value:a,source:{fromUi:!0}})},[t]);Ce({element:t,widgetMgr:n,onFormCleared:ne});const le=a=>{const{value:u}=a.target;if(u==="")w(!0),x(null),I(null);else{let p;t.dataType===T.DataType.INT?p=parseInt(u,10):p=parseFloat(u),w(!0),x(p),I(u)}},j=o.useCallback(()=>{E&&(w(!0),c({value:(d??y)+l,source:{fromUi:!0}}))},[d,y,l,E]),D=o.useCallback(()=>{k&&(w(!0),c({value:(d??v)-l,source:{fromUi:!0}}))},[d,v,l,k]),ie=o.useCallback(a=>{const{key:u}=a;switch(u){case"ArrowUp":a.preventDefault(),j();break;case"ArrowDown":a.preventDefault(),D();break}},[j,D]),se=o.useCallback(a=>{a.key==="Enter"&&(g&&c({value:d,source:{fromUi:!0}}),n.allowFormEnterToSubmit(m)&&n.submitForm(m,f))},[g,d,c,n,m,f]),O=V?.startsWith(":material"),de=O?"lg":"base",ue=P(r.iconSizes.lg)+2*P(r.spacing.twoXS),ce=V?r.breakpoints.hideNumberInputControls+ue:r.breakpoints.hideNumberInputControls;return i.jsxs("div",{className:"stNumberInput","data-testid":"stNumberInput",ref:q,children:[i.jsx(be,{label:t.label,disabled:e,labelVisibility:ge(t.labelVisibility?.value),htmlFor:U.current,children:t.help&&i.jsx(he,{children:i.jsx(ye,{content:t.help,placement:ve.TOP_RIGHT})})}),i.jsxs(Re,{className:L?"focused":"","data-testid":"stNumberInputContainer",children:[i.jsx(Ee,{type:"number",inputRef:C,value:A??"",placeholder:t.placeholder,onBlur:oe,onFocus:ae,onChange:le,onKeyPress:se,onKeyDown:ie,clearable:z,clearOnEscape:z,disabled:e,"aria-label":t.label,startEnhancer:t.icon&&i.jsx(Te,{"data-testid":"stNumberInputIcon",iconValue:t.icon,size:de}),id:U.current,overrides:{ClearIconContainer:{style:{padding:0}},ClearIcon:{props:{overrides:{Svg:{style:{color:r.colors.grayTextColor,padding:r.spacing.threeXS,height:r.sizes.clearIconSize,width:r.sizes.clearIconSize,":hover":{fill:r.colors.bodyText}}}}}},Input:{props:{"data-testid":"stNumberInputField",step:l,min:y,max:v,type:"number",inputMode:""},style:{fontWeight:r.fontWeights.normal,lineHeight:r.lineHeights.inputWidget,paddingRight:r.spacing.sm,paddingLeft:r.spacing.md,paddingBottom:r.spacing.sm,paddingTop:r.spacing.sm,"::placeholder":{color:r.colors.fadedText60}}},InputContainer:{style:()=>({borderTopRightRadius:0,borderBottomRightRadius:0})},Root:{style:{borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,borderBottomWidth:0,paddingRight:0,paddingLeft:V?r.spacing.sm:0}},StartEnhancer:{style:{paddingLeft:0,paddingRight:0,minWidth:r.iconSizes.lg,color:O?r.colors.fadedText60:"inherit"}}}}),F>ce&&i.jsxs(Se,{children:[i.jsx(G,{"data-testid":"stNumberInputStepDown",onClick:D,disabled:!k||e,tabIndex:-1,children:i.jsx(_,{content:Y,size:"xs",color:k?"inherit":r.colors.fadedText40})}),i.jsx(G,{"data-testid":"stNumberInputStepUp",onClick:j,disabled:!E||e,tabIndex:-1,children:i.jsx(_,{content:Z,size:"xs",color:E?"inherit":r.colors.fadedText40})})]})]}),re&&i.jsx(Ne,{clearable:z,children:i.jsx(Ie,{dirty:g,value:A??"",inForm:M,allowEnterToSubmit:te})})]})},Oe=o.memo(Fe);export{Oe as default};
