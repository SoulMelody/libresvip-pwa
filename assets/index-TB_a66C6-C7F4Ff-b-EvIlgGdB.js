import{r as a,m as pe,f as me,ds as fe,x as G,dE as x,v as h,O,j as n,cj as be,ck as ge,cD as he,cl as ye,c5 as ve,c as S,ae as xe,cs as _,l as Te,E as Q,_ as Y}from"./index-Dl0ak3r9.js";import{m as we}from"./uniqueId-BK5M3tCR-CSs6b9YK-C8HzRRO_.js";import{b as Ie}from"./InputInstructions-CBRIlV8X-CPGrpFwg-DP5TUEWs.js";import{l as Ce}from"./FormClearHelper-C8nMSLiM-ZOoPDlL1-Bkd7LQt0.js";import{S as ke}from"./sprintf-D5E86llw-yUkJWEcD-CuWy5xoB.js";import{u as Ee}from"./input-BSWdlTrr-C9att7bR-eHkORSuG.js";import"./base-input-BJvYf_Lh-D5KAo0d3-C7bNWeyu.js";var Z=a.forwardRef(function(e,t){var l={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return a.createElement(Q,Y({iconAttrs:l,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},e,{ref:t}),a.createElement("path",{d:"M0 3v2h8V3H0z"}))});Z.displayName="Minus";var q=a.forwardRef(function(e,t){var l={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return a.createElement(Q,Y({iconAttrs:l,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},e,{ref:t}),a.createElement("path",{d:"M3 0v3H0v2h3v3h2V5h3V3H5V0H3z"}))});q.displayName="Plus";const Re=S("div",{target:"e116k4er3"})(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center",height:e.sizes.minElementHeight,borderWidth:e.sizes.borderWidth,borderStyle:"solid",borderColor:e.colors.widgetBorderColor??e.colors.secondaryBg,transitionDuration:"200ms",transitionProperty:"border",transitionTimingFunction:"cubic-bezier(0.2, 0.8, 0.4, 1)",borderRadius:e.radii.default,overflow:"hidden","&.focused":{borderColor:e.colors.primary},input:{MozAppearance:"textfield","&::-webkit-inner-spin-button, &::-webkit-outer-spin-button":{WebkitAppearance:"none",margin:e.spacing.none}}}),""),Se=S("div",{target:"e116k4er2"})({name:"76z9jo",styles:"display:flex;flex-direction:row;align-self:stretch"}),X=S("button",{target:"e116k4er1"})(({theme:e})=>({margin:e.spacing.none,border:"none",height:e.sizes.full,display:"flex",alignItems:"center",width:e.sizes.numberInputControlsWidth,justifyContent:"center",color:e.colors.bodyText,transition:"color 300ms, backgroundColor 300ms",backgroundColor:e.colors.secondaryBg,"&:hover:enabled, &:focus:enabled":{color:e.colors.white,backgroundColor:e.colors.primary,transition:"none",outline:"none"},"&:active":{outline:"none",border:"none"},"&:disabled":{cursor:"not-allowed",color:e.colors.fadedText40}}),""),Ne=S("div",{target:"e116k4er0"})(({theme:e,clearable:t})=>({position:"absolute",marginRight:e.spacing.twoXS,left:0,right:`calc(${e.sizes.numberInputControlsWidth} * 2 + ${t?"1em":"0em"})`}),""),Ve=Te.getLogger("NumberInput");function De(e){return h(e)||e===""?void 0:e}const R=({value:e,format:t,step:l,dataType:f})=>{if(h(e))return null;let r=De(t);if(h(r)&&G(l)){const s=l.toString();f===x.DataType.FLOAT&&l!==0&&s.includes(".")&&(r=`%0.${s.split(".")[1].length}f`)}if(h(r))return e.toString();try{return ke.sprintf(r,e)}catch(s){return Ve.warn(`Error in sprintf(${r}, ${e}): ${s}`),String(e)}},je=(e,t,l)=>h(e)?!1:e-t>=l,ze=(e,t,l)=>h(e)?!1:e+t<=l,We=e=>(e.element.dataType===x.DataType.INT?e.widgetMgr.getIntValue(e.element):e.widgetMgr.getDoubleValue(e.element))??e.element.default??null,K=({step:e,dataType:t})=>e||(t===x.DataType.INT?1:.01),Fe=({disabled:e,element:t,widgetMgr:l,fragmentId:f})=>{const r=pe(),{dataType:s,id:N,formId:m,default:W,format:b,icon:V,min:y,max:v}=t,{width:F,elementRef:J}=me(),[i,ee]=a.useState(()=>K(t)),L=We({element:t,widgetMgr:l}),[g,T]=a.useState(!1),[d,w]=a.useState(L),[$,B]=a.useState(!1),C=a.useRef(null),M=a.useRef(we("number_input_")),[U,I]=a.useState(()=>R({value:L,dataType:s,format:b,step:i})),k=je(d,i,y),E=ze(d,i,v),A=fe({formId:m}),te=A?l.allowFormEnterToSubmit(m):g,re=$&&F>r.breakpoints.hideWidgetDetails;a.useEffect(()=>{ee(K({step:t.step,dataType:t.dataType}))},[t.dataType,t.step]),a.useEffect(()=>{g||I(R({value:d,dataType:s,format:b,step:i}))},[s,b,i]);const c=a.useCallback(({value:o,source:u})=>{if(G(o)&&(y>o||o>v))C.current?.reportValidity();else{const p=o??W??null;switch(s){case x.DataType.INT:l.setIntValue({id:N,formId:m},p,u,f);break;case x.DataType.FLOAT:l.setDoubleValue({id:N,formId:m},p,u,f);break;default:throw new Error("Invalid data type")}T(!1),w(p),I(R({value:p,dataType:s,format:b,step:i}))}},[y,v,C,l,f,i,s,N,m,W,b]),ae=a.useCallback(()=>{g&&c({value:d,source:{fromUi:!0}}),B(!1)},[g,d,c]),oe=a.useCallback(()=>{B(!0)},[]),H=a.useCallback(()=>{const{value:o}=t;t.setValue=!1,w(o??null),I(R({value:o??null,dataType:s,format:b,step:i})),c({value:o??null,source:{fromUi:!1}})},[t,i,c,s,b]);a.useEffect(()=>{t.setValue?H():c({value:d,source:{fromUi:!1}});const o=C.current;if(o){const u=p=>{p.preventDefault()};return o.addEventListener("wheel",u),()=>{o.removeEventListener("wheel",u)}}},[]),t.setValue&&H();const D=h(t.default)&&!e,le=a.useCallback(()=>{const o=t.default??null;w(o),c({value:o,source:{fromUi:!0}})},[t]);Ce({element:t,widgetMgr:l,onFormCleared:le});const ie=o=>{const{value:u}=o.target;if(u==="")T(!0),w(null),I(null);else{let p;t.dataType===x.DataType.INT?p=parseInt(u,10):p=parseFloat(u),T(!0),w(p),I(u)}},j=a.useCallback(()=>{E&&(T(!0),c({value:(d??y)+i,source:{fromUi:!0}}))},[d,y,i,E]),z=a.useCallback(()=>{k&&(T(!0),c({value:(d??v)-i,source:{fromUi:!0}}))},[d,v,i,k]),ne=a.useCallback(o=>{const{key:u}=o;switch(u){case"ArrowUp":o.preventDefault(),j();break;case"ArrowDown":o.preventDefault(),z();break}},[j,z]),se=a.useCallback(o=>{o.key==="Enter"&&(g&&c({value:d,source:{fromUi:!0}}),l.allowFormEnterToSubmit(m)&&l.submitForm(m,f))},[g,d,c,l,m,f]),P=V?.startsWith(":material"),de=P?"lg":"base",ue=O(r.iconSizes.lg)+2*O(r.spacing.twoXS),ce=V?r.breakpoints.hideNumberInputControls+ue:r.breakpoints.hideNumberInputControls;return n.jsxs("div",{className:"stNumberInput","data-testid":"stNumberInput",ref:J,children:[n.jsx(be,{label:t.label,disabled:e,labelVisibility:ge(t.labelVisibility?.value),htmlFor:M.current,children:t.help&&n.jsx(he,{children:n.jsx(ye,{content:t.help,placement:ve.TOP_RIGHT})})}),n.jsxs(Re,{className:$?"focused":"","data-testid":"stNumberInputContainer",children:[n.jsx(Ee,{type:"number",inputRef:C,value:U??"",placeholder:t.placeholder,onBlur:ae,onFocus:oe,onChange:ie,onKeyPress:se,onKeyDown:ne,clearable:D,clearOnEscape:D,disabled:e,"aria-label":t.label,startEnhancer:t.icon&&n.jsx(xe,{"data-testid":"stNumberInputIcon",iconValue:t.icon,size:de}),id:M.current,overrides:{ClearIconContainer:{style:{padding:0}},ClearIcon:{props:{overrides:{Svg:{style:{color:r.colors.grayTextColor,padding:r.spacing.threeXS,height:r.sizes.clearIconSize,width:r.sizes.clearIconSize,":hover":{fill:r.colors.bodyText}}}}}},Input:{props:{"data-testid":"stNumberInputField",step:i,min:y,max:v,type:"number",inputMode:""},style:{fontWeight:r.fontWeights.normal,lineHeight:r.lineHeights.inputWidget,paddingRight:r.spacing.sm,paddingLeft:r.spacing.md,paddingBottom:r.spacing.sm,paddingTop:r.spacing.sm,"::placeholder":{color:r.colors.fadedText60}}},InputContainer:{style:()=>({borderTopRightRadius:0,borderBottomRightRadius:0})},Root:{style:{borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,borderBottomWidth:0,paddingRight:0,paddingLeft:V?r.spacing.sm:0}},StartEnhancer:{style:{paddingLeft:0,paddingRight:0,minWidth:r.iconSizes.lg,color:P?r.colors.fadedText60:"inherit"}}}}),F>ce&&n.jsxs(Se,{children:[n.jsx(X,{"data-testid":"stNumberInputStepDown",onClick:z,disabled:!k||e,tabIndex:-1,children:n.jsx(_,{content:Z,size:"xs",color:k?"inherit":r.colors.fadedText40})}),n.jsx(X,{"data-testid":"stNumberInputStepUp",onClick:j,disabled:!E||e,tabIndex:-1,children:n.jsx(_,{content:q,size:"xs",color:E?"inherit":r.colors.fadedText40})})]})]}),re&&n.jsx(Ne,{clearable:D,children:n.jsx(Ie,{dirty:g,value:U??"",inForm:A,allowEnterToSubmit:te})})]})},Pe=a.memo(Fe);export{Pe as default};
